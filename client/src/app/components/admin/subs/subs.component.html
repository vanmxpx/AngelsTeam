<div class="container">
    <div class="header">
        <div class="notification">
            <div class="message mat-typography">
                <h3>Новых запросов: <strong>{{newUsers}}</strong></h3> <button mat-raised-button>Просмотреть</button>
            </div>
        </div>
        <mat-form-field class="actions">
            <div class="title">
                <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Поиск..">
            </div>
        </mat-form-field>
    </div>
    <div class="table">
        <table mat-table [dataSource]="dataSourceSubs" matSort #sortSubs="matSort">

            <!-- ID Column -->
            <ng-container matColumnDef="Id">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> # </th>
              <td mat-cell *matCellDef="let row"> {{row.Id}} </td>
            </ng-container>
        
            <!-- Name Column -->
            <ng-container matColumnDef="Name">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Имя </th>
              <td mat-cell *matCellDef="let row"> {{row.Name}} </td>
            </ng-container>
        
            <!-- Contact Column -->
            <ng-container matColumnDef="Contact">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Телеграм </th>
              <td mat-cell *matCellDef="let row"> {{row.Contact}} </td>
            </ng-container>
        
            <!-- Subscription Column -->
            <ng-container matColumnDef="Sub">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Подписка </th>
                <td mat-cell *matCellDef="let row"> {{row.Sub}} </td>
            </ng-container>

            <!-- Sub left Column -->
            <ng-container matColumnDef="SubLeft">
              <th mat-header-cell *matHeaderCellDef mat-sort-header> Осталось </th>
              <td mat-cell *matCellDef="let row">
                <ng-container *ngIf="!row.NewUser && row.Sub === 'MOUNTH'">
                    {{row.SubLeft}} суток
                  </ng-container>
              </td>
            </ng-container>

            <!-- Apply new Column -->
            <ng-container matColumnDef="NewUser">
                <th mat-header-cell *matHeaderCellDef mat-sort-header> Новый </th>
                <td mat-cell *matCellDef="let row">
                    <ng-container *ngIf="row.NewUser && row.Sub !== 'FREE'">
                        <button matTooltip="Подтвердить подписку" (click)="apply(row)" mat-icon-button>
                            <mat-icon style="color: green">done</mat-icon>
                        </button>
                    </ng-container>
                </td>
            </ng-container>

            <!-- Edit Column -->
            <ng-container matColumnDef="Edit">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let row">
                    <button matTooltip="Править" mat-icon-button (click)="addNew(row)">
                        <mat-icon style="color: rgb(35, 35, 161)">edit</mat-icon>
                    </button>
                </td>
            </ng-container>

            <!-- Remove Column -->
            <ng-container matColumnDef="Remove">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let row">
                    <ng-container *ngIf="row.Sub !== 'FREE'">                 
                        <button matTooltip="Удалить подписку" mat-icon-button (click)="expandedElement = row">
                            <mat-icon style="color: red">close</mat-icon>
                        </button>
                    </ng-container>
                </td>
            </ng-container>
        
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row mat-ripple class="element-row" *matRowDef="let row; columns: displayedColumns;"
            [cdkDetailRow]="row" [cdkDetailRowTpl]="tpl" [cdkExpandedRow]="expandedElement"></tr>
          </table>
        
          <mat-paginator #paginatorSubs [pageSizeOptions]="[5, 10, 25, 100]" [pageSize]="10"></mat-paginator>
    </div>
</div>

<ng-template #tpl let-element>  
    <tr class="mat-row detail-row" [@detailExpand]> 
    <td colspan="8">

            Вы хотите убрать подписку?
            <button mat-mini-fab class="apply-remove" (click)="removeSign()"><mat-icon>done</mat-icon></button>
            <button mat-mini-fab class="dis-remove" (click)="dismissRemove()"><mat-icon>close</mat-icon></button>

    </td>
</tr> 
</ng-template>